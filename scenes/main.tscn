[gd_scene load_steps=15 format=3 uid="uid://dmujgct7j0jq"]

[ext_resource type="PackedScene" uid="uid://dfwhkhol7mfff" path="res://scenes/player.tscn" id="1_8if2x"]
[ext_resource type="Script" path="res://scripts/main.gd" id="1_bw2ht"]
[ext_resource type="PackedScene" uid="uid://nj81u3qmrwq7" path="res://scenes/background.tscn" id="1_t8rk7"]
[ext_resource type="Texture2D" uid="uid://j7s2wmdxfvtw" path="res://assets/backgrounds/waves.jpg" id="3_jsfnp"]
[ext_resource type="Texture2D" uid="uid://cmijt3pn8jtfq" path="res://assets/backgrounds/foam.jpg" id="4_2kfm5"]
[ext_resource type="PackedScene" uid="uid://bbl8rqlmhufue" path="res://scenes/pause.tscn" id="4_8d2ge"]
[ext_resource type="Texture2D" uid="uid://86ej0ddc0jjh" path="res://assets/backgrounds/bubbles-30-opacity.png" id="4_bnkoc"]
[ext_resource type="PackedScene" uid="uid://bi7e6b8a2ue6p" path="res://scenes/player_health_bar.tscn" id="4_kc4cn"]
[ext_resource type="PackedScene" uid="uid://bstxmoqmg6epi" path="res://scenes/score.tscn" id="4_qno8n"]
[ext_resource type="PackedScene" uid="uid://ckfabkssvqr3s" path="res://scenes/special.tscn" id="5_bwqbv"]
[ext_resource type="Texture2D" uid="uid://b7q5d5urbahnh" path="res://assets/backgrounds/ripples.jpg" id="5_sbo20"]
[ext_resource type="PackedScene" uid="uid://chftm345jv2bv" path="res://scenes/stats.tscn" id="7_35p0l"]
[ext_resource type="PackedScene" uid="uid://dq4f7ttthp0en" path="res://scenes/game_over.tscn" id="8_6op73"]
[ext_resource type="PackedScene" uid="uid://ceckwpqwfrg3b" path="res://scenes/fade_out.tscn" id="9_31iox"]

[node name="Main" type="Node2D"]
process_mode = 3
script = ExtResource("1_bw2ht")

[node name="WaveStartTimer" type="Timer" parent="."]
unique_name_in_owner = true
process_mode = 1
wait_time = 1.5
one_shot = true

[node name="WaveEndTimer" type="Timer" parent="."]
unique_name_in_owner = true
wait_time = 1.5
one_shot = true

[node name="Background" parent="." instance=ExtResource("1_t8rk7")]
process_mode = 1
base_texture = ExtResource("3_jsfnp")
lower_texture = ExtResource("4_bnkoc")
middle_texture = ExtResource("4_2kfm5")
top_texture = ExtResource("5_sbo20")
lower_rotation = -2.0
top_rotation = -5.0

[node name="Projectiles" type="Node" parent="."]
unique_name_in_owner = true
process_mode = 1

[node name="Player" parent="." node_paths=PackedStringArray("starting_position") instance=ExtResource("1_8if2x")]
unique_name_in_owner = true
process_mode = 1
z_index = 1
position = Vector2(590, 379)
starting_position = NodePath("../ScreenCentre")

[node name="Enemies" type="Node" parent="."]
unique_name_in_owner = true
process_mode = 1

[node name="Walls" type="StaticBody2D" parent="."]
process_mode = 1
collision_mask = 0
metadata/_edit_group_ = true
metadata/_edit_lock_ = true

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Walls"]
polygon = PackedVector2Array(-363, 20, 1260, 20, 1260, 700, 20, 700, 20, 0, -282, -61, -266, 941, 1527, 945, 1484, -238, -273, -233)

[node name="BulletDespawner" type="Area2D" parent="." groups=["bullet_despawner"]]
process_mode = 1
metadata/_edit_group_ = true
metadata/_edit_lock_ = true

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="BulletDespawner"]
polygon = PackedVector2Array(-2380, -50, 1330, -50, 1330, 780, -50, 780, -50, -554, -2290, -582, -2310, 2638, 3610, 2586, 3486, -2210, -2272, -2177)

[node name="EnemyDespawner" type="Area2D" parent="." groups=["enemy_despawner"]]
process_mode = 1
metadata/_edit_group_ = true

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="EnemyDespawner"]
polygon = PackedVector2Array(-2142, -229, 1495, -245, 1532, 950, -270, 945, -257, -2149, -2195, -2121, -2225, 2538, 3521, 2515, 3400, -2189, -2134, -2068)
metadata/_edit_lock_ = true

[node name="ScreenCentre" type="Marker2D" parent="."]
position = Vector2(640, 360)

[node name="UI" type="CanvasLayer" parent="."]
process_mode = 1

[node name="PlayerHealthBar" parent="UI" instance=ExtResource("4_kc4cn")]
unique_name_in_owner = true

[node name="Special" parent="UI" instance=ExtResource("5_bwqbv")]
unique_name_in_owner = true

[node name="Score" parent="UI" instance=ExtResource("4_qno8n")]
unique_name_in_owner = true

[node name="Stats" parent="UI" instance=ExtResource("7_35p0l")]
unique_name_in_owner = true
visible = false

[node name="GameOver" parent="UI" instance=ExtResource("8_6op73")]
unique_name_in_owner = true
visible = false

[node name="FadeOut" parent="UI" instance=ExtResource("9_31iox")]

[node name="Pause" parent="UI" instance=ExtResource("4_8d2ge")]
unique_name_in_owner = true
process_mode = 2
visible = false

[connection signal="timeout" from="WaveStartTimer" to="." method="_on_wave_start_timer_timeout"]
[connection signal="timeout" from="WaveEndTimer" to="." method="_show_stats_screen"]
[connection signal="stat_increased" from="UI/Stats" to="." method="_on_stat_increased"]
